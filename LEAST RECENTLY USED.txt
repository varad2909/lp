#include <iostream>
#include <vector>
using namespace std;

int main() {
    int n, f;

    // User input
    cout << "Enter the number of pages: ";
    cin >> n;

    vector<int> pages(n);
    cout << "Enter the reference string (page numbers): ";
    for (int i = 0; i < n; i++) {
        cin >> pages[i];
    }

    cout << "Enter the number of frames: ";
    cin >> f;

    vector<int> frames(f, -1);  // -1 indicates empty frame
    vector<int> recent(f, 0);   // Track age for LRU

    int pageFaults = 0;
    int pageHits = 0;

    cout << "\n===== LRU Page Replacement Simulation =====\n";

    // For each page reference
    for (int i = 0; i < n; i++) {
        int page = pages[i];
        bool hit = false;

        // Check if page is already in frame (page hit)
        for (int j = 0; j < f; j++) {
            if (frames[j] == page) {
                hit = true;
                pageHits++;
                break;
            }
        }

        // Page miss
        if (!hit) {
            pageFaults++;

            // Find empty frame
            bool placed = false;
            for (int j = 0; j < f; j++) {
                if (frames[j] == -1) {
                    frames[j] = page;
                    placed = true;
                    break;
                }
            }

            // If no empty frame → replace LRU
            if (!placed) {
                vector<int> age(f);
                for (int j = 0; j < f; j++) {
                    int count = 0;
                    for (int k = i - 1; k >= 0; k--) {
                        if (pages[k] == frames[j])
                            break;
                        count++;
                    }
                    age[j] = count;
                }

                // Find the frame with the maximum age (least recently used)
                int maxAge = age[0];
                int replaceIndex = 0;
                for (int j = 1; j < f; j++) {
                    if (age[j] > maxAge) {
                        maxAge = age[j];
                        replaceIndex = j;
                    }
                }

                frames[replaceIndex] = page;
            }
        }

        // Print current frame contents
        cout << "After referencing page " << page << " → Frames: ";
        for (int j = 0; j < f; j++) {
            if (frames[j] == -1)
                cout << "- ";
            else
                cout << frames[j] << " ";
        }
        cout << (hit ? " (Hit)" : " (Fault)") << endl;
    }

    cout << "\n===== Final Results =====\n";
    cout << "Total Page References: " << n << endl;
    cout << "Total Page Hits:       " << pageHits << endl;
    cout << "Total Page Faults:     " << pageFaults << endl;
    cout << "Hit Ratio:   " << ((float)pageHits / n) * 100 << "%" << endl;
    cout << "Fault Ratio: " << ((float)pageFaults / n) * 100 << "%" << endl;

    return 0;
}


/*sample input:-
              
		Enter the number of pages: 12
Enter the reference string (page numbers): 1 2 3 4 1 2 5 1 2 3 4 5
Enter the number of frames: 3*/
